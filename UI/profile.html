<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="/images/icon.png" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignUp</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="profile.css">
    <script src="./script.js"></script>
    <script>
        window.onload = tologin()
    </script>
</head>
<body>
    <nav>
        <div class="logo">
            <a href="./index.html#portfolio-intro"><img  src="./images/ED.png" alt="logo"></a>
            <div class="menu" onclick="toggleNav()" >
                <img  src="./images/open.png" id="ig"  alt="image">
            </div>
        </div>
        <div id="actions"  >
            <div class="links">
                <a href="./index.html#about-me">About Me</a>
                <a href="./index.html#skills" >Skills</a>
                <a href="./blog.html">Blog</a>
                <a href="./contacts.html">Contacts</a>
            </div>
            <button id="dashbutton" onclick="toDashboard()">Dashboard</button>
            <button id="loginbutton" onclick="tologin()">Login</button>
            <img  src="./images/dpicon.png" class="propic" id="profilePic" onclick="displayWow()">
            </img>
            <div class="wow-menu" id="wowM">
                <button onclick="toProfile()">Profile</button>
                <button onclick="logOut()">Log Out</button>
            </div>
            
            <script>
                window.onload = showLoginButton();
                window.onload = toDashButton();
            </script>
        </div>
    </nav>
    <script>
        function hide() {
            document.getElementById('donepop').style.display = "block"
        }
        function rehide() {
            document.getElementById("donepop").style.display = "none"
        }
    </script>
    <div class="login-container">
        <div id="popcontact" onclick="rehide()">
                
        </div>
        <div class="container-box">
            <div class="right" >
                <div class="username-box">
                    <div class="username"><div id="username"></div><button onclick="event.preventDefault(); showform('uform','chngtext')">Change</button></div>
                    <form onsubmit="event.preventDefault(); changeusername()" id="uform" style="display: none;">
                        <input type="text" name="username"><button>Save</button>
                    </form>
                </div>
                <div class="ppform">
                    <div class="lock">
                        <img src="./images/addimage.png" alt="" id="imageReceiver">
                        <form onsubmit="event.preventDefault(); changeprofilepic()">
                            <input type="file" name="image" style="display: none;" id="image">
                            <button id="dpbtn" style="display: none; margin-bottom: 10px;">Save</button>
                        </form>
                        <button onclick="document.getElementById('image').click(); showform('dpbtn','chngtext')">Change Profile Pic</button>
                    </div>
                </div>
                <div class="password-box">
                    <button id="chngtext" onclick="event.preventDefault(); showform('pform','chngtext')">Change Password</button>
                    <form onsubmit="event.preventDefault(); changepassword()" id="pform" style="display: none;">
                        <input type="password" name="password" id=""><button>Save</button>
                    </form>
                </div>
                <script>
                    function showform(x,y) {
                        const elem = document.getElementById(x)
                        const pelem = document.getElementById(y)
                        if(elem.style.display == "none") {
                            elem.style.display = "flex"
                        }else {
                            elem.style.display = "none"
                        }
                        //pelem.display = "none"
                        
                    }
                </script>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="footer-box">
          <div class="social">
            <a href='https://www.instagram.com/___e.d.d.y/' target="_blank"><img src="./images/instagram.png" alt='instagram' /></a>
            <a href='https://www.linkedin.com/in/eddy-mugisha-4b4a5219a/' target="_blank"><img src="./images/linkedin.png" alt='linkedin' /></a>
            
            <a href='https://www.linkedin.com/in/eddy-mugisha-4b4a5219a/' target="_blank"><img src="./images/twitter.png" alt='twitter' /></a>
            <a href='https://www.linkedin.com/in/eddy-mugisha-4b4a5219a/' target="_blank"><img src="./images/whatsapp.png" alt='whatsapp' /></a>
            <a href='' target="_blank"><img src="./images/gmail.png" alt='gmail' /></a>
          </div>
        </div>
        <div class="copyright">
          <p>All rights reserved by M.J.Eddy 2022 &copy;</p>
        </div>
    </div>
    <script>
        window.onload = document.getElementById("username").innerHTML = JSON.parse(localStorage.getItem("tempLog")).username
        window.onload = displayPP()
        function displayPP() {
        if(JSON.parse(localStorage.getItem("tempLog")).imageUrl != "")
            document.getElementById("profilePic").src = JSON.parse(localStorage.getItem("tempLog")).imageUrl
            document.getElementById("imageReceiver").src = JSON.parse(localStorage.getItem("tempLog")).imageUrl
        }
        fileEl = document.getElementById('image')
        fileEl.addEventListener('change', () => {
            const fr = new FileReader();
            fr.readAsDataURL(fileEl.files[0]);
            fr.addEventListener('load', () => {
                url = fr.result;
                img = document.getElementById("imageReceiver")
                img.src = url;
                try {
                    window.localStorage.setItem('tempImage', url);
                  } catch(e) {
                    if (e.code == 22) {
                      popContact("Image Too Big", "red")
                    }
                  }
            })
        }) 
        document.getElementById("loginbutton").style.display = "none"
        
        function togglePasswordVisibility() {
            var x = document.getElementById("pass");
            if (x.type === "password") {
              x.type = "text";
            } else {
              x.type = "password";
            }
          }
        function hideWhenAdmin() {
            const fr = document.getElementById("pass")
            const fr1 = document.getElementById("pass1")
            const fr2 = document.getElementById("name")
            const fr3 = document.getElementById("save")
            const fr4 = document.getElementById("image")
            fr.style.display = "none"
            fr1.style.display = "none"
            fr2.style.display = "none"
            fr3.style.display = "none"
            fr4.style.display = "none"
        }
        

    </script>
    <script>
        window.onbeforeunload = function(){
            localStorage.removeItem("tempImage")
         }
    </script>
</body>
</html>