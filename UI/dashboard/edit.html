<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="../images/icon.png" >
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet"> 
    <script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>  
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
</head>
<body>
    <nav>
        <span onclick="toggleDashNav()"><img src="../images/menu2.png" alt="menu"></span>
        <div class="logo"><img src="../images/ED.png" alt=""></div>
        <div class="links" id="wowM">
            <a href="../index.html">Portfolio</a>
            <a href="../contacts.html">Contacts</a>
            <a href="../blog.html">Blogs</a>
            <button onclick="logOut()">Log Out</button>
        </div>
        <div class="dp" onclick="displayWow()">
            <img src="../images/dp.jpg" alt="dp" >
        </div>
    </nav>
    <div id="popcontact" onclick="rehide()">
        Blog Posted
    </div>
    <div class="dash-container">
        <div id="dash-nav">
            <a href="./dashboard.html">Dashboard</a>
            <a href="./new.html">New Blog</a>
            <a href="./messages.html">Messages</a>
            <a href="./settings.html">Settings</a>
            
        </div>
        <div class="new">
            <div class="new-box" id="imgreceiver">
                <div class="title">Edit Blog </div>
                <form onsubmit="event.preventDefault(); editBlog(x)" id="frm">
                    <label for="title">Title</label>
                    <input type="text" name="title" id="title">
                    <label for="file">Add Photo</label>
                    <input type="file" name="image" id="image">
                    <div class="imageholder" id="imageholder">

                    </div>
                    <label for="content">Blog Content</label>
                    <div name="content" id="content" cols="30" rows="10"></div>
                    <button style="background: green;">EDIT BLOG</button>
                </form>
            </div>
        </div>
    </div>
    <script>
        let Bloge = JSON.parse(window.localStorage.getItem("Blogs"))
        let x;
        var parts = window.location.search.substr(1).split("&");
        var m = {};
        for (var i = 0; i < parts.length; i++) {
            var temp = parts[i].split("=");
            
            m[decodeURIComponent(temp[0])] = decodeURIComponent(temp[1]);
            
        }
        x = m['id']
        var idx = Bloge.findIndex(function(item, i){
            return item._id == x
        });
        function showEdit(){
            let Bloge = JSON.parse(window.localStorage.getItem("Blogs"))
            document.getElementById("title").value = Bloge[idx].title
            document.getElementById("content").innerHTML = Bloge[idx].content
            const img = new Image()
            img.src = Bloge[idx].image
            img.classList.add("insertedImage")
            document.getElementById("imageholder").appendChild(img)
        }
        window.onload = showEdit()
    </script>
    <script>
        fileEl = document.getElementById('image')
        const h = document.getElementById("imageholder")
        fileEl.addEventListener('change', () => {
            const fr = new FileReader();
            fr.readAsDataURL(fileEl.files[0]);
            fr.addEventListener('load', () => {
                url = fr.result;
                const imge = new Image()
                imge.src = url
                imge.classList.add("insertedImage")
                let m = document.querySelector("#imgreceiver")
                window.localStorage.setItem("tempImage", url)
                h.appendChild(imge)
            })
        }) 
    </script>
    
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="./quill.js"></script>
    <script src="../script.js" ></script>
    <script>
        window.onload = che()
    </script>
</body>
</html>