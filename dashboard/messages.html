<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="../images/icon.png" >
    <script src="../script.js"></script>
    <script>
        window.onload = che()
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
</head>
<body>
    <nav>
        <span onclick="toggleDashNav()"><img src="../images/menu2.png" alt="menu"></span>
        <div class="logo"><img src="../images/ED.png" alt=""></div>
        <div class="links">
            <a href="../index.html">Portfolio</a>
            <button onclick="logOut()">Log Out</button>
            <div class="dp">
                <img src="../images/dp.jpg" alt="dp">
            </div>
        </div>
    </nav>
    <div class="dash-container">
        <div id="popcontact">
            
        </div>
        <div id="dash-nav">
            <a href="./dashboard.html">Dashboard</a>
            <a href="./new.html">New Blog</a>
            <a href="./messages.html">Messages</a>
            <a href="./settings.html">Settings</a>
            
        </div>
        <div class="messages">
            <div class="msg-box">
                <div class="title">Messages <button onclick="deleteAllMessages()">Delete All</button></div>
                <div class="msg-container" id="box" onload="list()" >
                    <script >
                        window.onload = list();
                        function list() {
                            let Messages = JSON.parse(localStorage.getItem("Messages"));
                            const list = document.querySelector('#box');
                            let arr = window.localStorage.getItem("Messages")
                            list.innerHTML = `${Messages.map((id, index)=>`<div class="msg" onclick="list()"><div class="msg-icon"><img src="../images/msg.png" alt="msg"></div>
                            <div class="name">${id['name']}</div>
                            <div class="content">${id['message']}</div>
                            <div class="ops">
                                <BUTton><img src="../images/reply.png" alt="reply"></BUTton>
                                <BUTton onclick="deleteMessage(${index})"> <img src="../images/trash.png" alt="trash"></BUTton>
                            </div></div>`).join("")}`
                          }
                        function deleteAllMessages() {
                            Messages = []
                            window.localStorage.removeItem("Messages");
                            popContact("All Messages Deleted")
                            setTimeout( () => {
                                location.reload();

                            } , 5000)
                        }
                        function deleteMessage(m) {
                            let Messages = JSON.parse(localStorage.getItem("Messages"));

                            console.log(m)
                            if (m > -1) { // only splice array when item is found
                                Messages.splice(m, 1); // 2nd parameter means remove one item only
                                window.localStorage.setItem("Messages", JSON.stringify(Messages));
                                popContact("Message Deleted")
                            }
                        }
                    </script>
                </div>
            </div>
            <!-- <div class="msg-box">
                <div class="title">Blog Suggestions</div>
                <div class="msg-container">
                    <div class="msg">
                        <div class="msg-icon"><img src="../images/msg.png" alt="msg"></div>
                        <div class="name">Topic Here</div>
                        <div class="content">Suggestion here</div>
                        <div class="ops">
                            <BUTton><img src="../images/reply.png" alt="reply"></BUTton>
                            <BUTton><img src="../images/trash.png" alt="trash"></BUTton>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>
</body>
</html>